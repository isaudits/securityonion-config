filter {
    if [type] == "wineventlog" {
        mutate {
            convert => [ "event_id", "string" ]
            convert => [ "process_id", "string" ]
            convert => [ "thread_id", "string" ]
            #Sometimes param1 contains a date which can wind up creating an index conflict
            convert => [ "event_data.param1", "string" ]
        }

        # Check for existence of IP and port info in event data and copy to src_ip and
        # src_port for consistent searches with other indices

        if [event_data][IpAddress] {
            # use grok to match ipv4 string since sometimes event will have both ipv4 and ipv6 in it
            grok {
                match => [ "[event_data][IpAddress]" , "%{IPV4:source_ip}" ]
            }
        }
        
        if [event_data][IpPort] {
            mutate { add_field => [ "source_port" , "%{[event_data][IpPort]}" ] }
        }
    }
}